
<div class="container">
	<div class="level_progress">
		<div class="progress progress_1">
			<div class="bar"></div>
		</div>
		<div class="progress progress_2">
			<div class="bar"></div>
		</div>
		<div class="level level_1 level_reached"><p>1</p></div>
		<div class="level level_2"><p>2</p></div>
		<div class="level level_3"><p>3</p></div>
	</div>
	<div class="mask"></div>

</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.0/TweenLite.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.0/easing/EasePack.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.0/plugins/CSSPlugin.min.js"></script>

<style>
  @import 'https://fonts.googleapis.com/css?family=Alfa+Slab+One';
.container {
	font-family:'Alfa Slab One';
	position:absolute;
	width:50%;
	height:200px;
	left:0;
	right:0;
	margin:auto;
	background-color: #00bbe8;
	overflow:hidden;
}
.container.level_2c {
	background-color: #C2B313;
}
.container.level_3c {
	background-color: #EC1865;
}

.mask {
	position:absolute;
	width:100%;
	height:100%;
	background: radial-gradient(ellipse at center, rgba(0,187,232,0) 0%, rgba(0,187,232,0.49) 41%, #00bbe8 50%, #00bbe8 94%);
}
.mask.level_2c {
	background: radial-gradient(ellipse at center, rgba(194,179,19,0) 0%, rgba(194,179,19,0.49) 41%, #C2B313 50%, #C2B313 94%);
}
.mask.level_3c {
	background: radial-gradient(ellipse at center, rgba(236,24,101,0) 0%, rgba(236,24,101,0.49) 41%, #EC1865 50%, #EC1865 94%);
}
.level_progress {
	position:relative;
	top:35%;
	left:0;
	width:75%;
	right:0;
	margin:auto;
}

.level {
	position:absolute;
	text-align: center;
	border-radius: 50%;
	background-color: white;
	border: 3px solid white;
	box-shadow: inset 0px 0px 0px 7px #0f7b9a;
	color: #0f7b9a;
	width: 40px;
	height: 40px;
}
.level p {
	margin:0;
	margin-top:9px;
	padding:0;
}

.level_1 {}
.level_2 {
	left:47.5%;
}
.level_3 {
	right:0;
}

.level_1.level_reached {
		background-color: white;
		color:#00bbe8;
	 border: 3px solid white;
		box-shadow: inset 0px 0px 0px 7px #00bbe8;
}

.level_2.level_reached {
		background-color: white;
		color:#C2B313;
	 border: 3px solid white;
		box-shadow: inset 0px 0px 0px 7px #C2B313;
}

.level_3.level_reached {
		background-color: white;
		color:#EC1865;
	  border: 3px solid white;
		box-shadow: inset 0px 0px 0px 7px #EC1865;
}

.progress {
	width:45%;
	background-color: #0f7b9a;
	height:10px;
	border:4px solid white;
	position:absolute;

	top:15px;
}

.progress_1 {
	left:2.5%;
}
.progress_2 {
	right:2.5%;
}

.bar {
	background-color: white;
	height: 100%;
	width:0;
	transform: skew(-30deg)
}

.progress .bar.step1 {
	width: 33.333%;
}
.progress .bar.step2 {
	width: 66.666%;
}
.progress .bar.step3 {
	width: 100%;
}

/*

@value level2: #C2B313;
@value level2_hover: #CCC152;
@value level2_darker: #8F840E;
@value level2_darkest: #61590a;
@value bg_level2_dark: #d3ce95;

@value level3: #EC1865;
@value level3_hover: #EF6094;
@value level3_darker: #B9124F;
@value level3_darkest: #6C2B43;
@value bg_level3_dark: #f1bfce;

*/
</style>
<script>

const levelProgress = document.querySelector('.level_progress');
let time = 0;
const container = document.querySelector('.container');
const mask = document.querySelector('.mask');
const bar_1 = document.querySelector('.progress_1 .bar');
const bar_2 = document.querySelector('.progress_2 .bar');
const levelBall_1 = document.querySelector('.level_1');
const levelBall_2 = document.querySelector('.level_2');
const levelBall_3 = document.querySelector('.level_3');

let level = 1;
let levelPoints = [0,0,0];

tween();
tick(time);

function tween() {
	TweenLite.to(bar_1, 0.5, {width: (levelPoints[0]/3 * 100).toString() + '%', ease:Expo.easeInOut});
	TweenLite.to(bar_2, 0.5, {width: (levelPoints[1]/6 * 100).toString() + '%', ease:Expo.easeInOut});
	TweenLite.to(levelProgress, 1, {left:(25 - 40*(level-1)).toString() +'%', ease:Expo.easeInOut})

	if (level === 1){
		TweenLite.to(container, 1, {className:"container", ease:Bounce.easeOut});
		TweenLite.to(mask, 1, {className:"mask", ease:Bounce.easeOut});
		TweenLite.to(levelProgress, .5,{left:'25%',scale:1.2, ease:Power1.easeInOut});
		TweenLite.to(levelBall_2, 0.5, {className:'-=level_reached', scale:1});
		TweenLite.to(levelBall_3, 0.5, {className:'-=level_reached', scale:1});
		TweenLite.to(levelBall_1, 0.7, {className:'+=level_reached', scale:1.3, ease: Bounce.easeOut, delay:.8});
	}
	if (level >=2) {
		TweenLite.to(container, 1, {className:"container level_2c", ease:Bounce.easeOut, delay: 0.8 });
		TweenLite.to(mask, 1, {className:"mask level_2c", ease:Bounce.easeOut, delay: 0.8 });
		TweenLite.to(levelBall_2, 0.7, {className:'+=level_reached', scale:1.3, ease: Bounce.easeOut, delay:.8});
	}
	if (level >=3) {
		TweenLite.to(container, 1, {className:"container level_3c", ease:Bounce.easeOut, delay: 0.8 });
		TweenLite.to(mask, 1, {className:"mask level_3c", ease:Bounce.easeOut, delay: 0.8 });
		TweenLite.to(levelBall_3, 0.7, {className:'+=level_reached', scale:1.3, ease: Bounce.easeOut, delay:.8});
	}
}

function tick() {
	time++;
	if (time%2 === 0) {
		update(time);
	}
	TweenLite.delayedCall(1, tick);
}

function update(time) {
	const rndPoints = 	Math.round(Math.random()*(level-1))+1;
	if (level === 3) {
		level = 1;
		levelPoints = [0,0,0];
	} else {
		levelPoints[level-1] =
			Math.min(levelPoints[level-1] + rndPoints, level*3);
	}
	if (levelPoints[level-1] >= 3*level ) {
		level += 1;
	}
	tween();
}
</script>
